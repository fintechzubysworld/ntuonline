<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>

<script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore-compat.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body{
background:#0f172a;
color:white;
font-family:Arial;
padding:20px;
}
.card{
background:#1e293b;
padding:15px;
border-radius:15px;
margin-bottom:20px;
}
input,textarea{
width:100%;
padding:8px;
margin-top:6px;
border-radius:10px;
border:none;
}
button{
margin-top:8px;
padding:8px 15px;
border:none;
border-radius:20px;
background:#f97316;
color:white;
cursor:pointer;
}
</style>
</head>

<body>

<h1>ðŸ›¡ Admin Dashboard</h1>

<div class="card">
<h2>ðŸ”´ Live Stream</h2>
<input id="liveId" placeholder="YouTube Video ID">
<input id="liveTitle" placeholder="Title">
<input id="liveDuration" type="number" placeholder="Auto end (minutes)">
<button onclick="startLive()">Go Live</button>
<button onclick="endLive()">End Now</button>
</div>

<div class="card">
<h2>ðŸ“… Create Event</h2>
<input id="title" placeholder="Title">
<textarea id="desc" placeholder="Description"></textarea>
<input type="date" id="date">
<input id="image" placeholder="Image URL">
<input id="video" placeholder="Video Embed URL">
<input id="audio" placeholder="Audio URL">
<button onclick="createEvent()">Create Event</button>
<div id="eventList"></div>
</div>

<div class="card">
<h2>ðŸ“° Post to Feed</h2>
<textarea id="feedText"></textarea>
<button onclick="postFeed()">Post</button>
</div>

<script>
const firebaseConfig={
apiKey:"AIzaSyDA02mVmQxC_cu2QCyq4NN8LhQIWo50V5A",
authDomain:"ntudioka-online-c29d8.firebaseapp.com",
projectId:"ntudioka-online-c29d8"
};
firebase.initializeApp(firebaseConfig);

const auth=firebase.auth();
const db=firebase.firestore();

auth.onAuthStateChanged(user=>{
if(!user || user.email!=="fintech.zubysworld@gmail.com"){
alert("Unauthorized");
window.location="index.html";
}
});

function startLive(){
const id=liveId.value;
const title=liveTitle.value;
const duration=parseInt(liveDuration.value);

db.collection("live").doc("current").set({
videoId:id,
title:title,
started:Date.now()
});

if(duration){
setTimeout(()=>{
db.collection("live").doc("current").delete();
},duration*60000);
}
}

function endLive(){
db.collection("live").doc("current").delete();
}

function createEvent(){
db.collection("events").add({
title:title.value,
description:desc.value,
date:date.value,
image:image.value||null,
video:video.value||null,
audio:audio.value||null,
created:Date.now()
});

title.value="";
desc.value="";
date.value="";
image.value="";
video.value="";
audio.value="";
}

function postFeed(){
db.collection("feed").add({
text:feedText.value,
created:Date.now(),
likes:0
});
feedText.value="";
}

db.collection("events").orderBy("created","desc")
.onSnapshot(s=>{
eventList.innerHTML="";
s.forEach(doc=>{
eventList.innerHTML+=`
<div>
${doc.data().title}
<button onclick="deleteEvent('${doc.id}')">Delete</button>
</div>`;
});
});

function deleteEvent(id){
db.collection("events").doc(id).delete();
}
</script>

</body>
</html>
